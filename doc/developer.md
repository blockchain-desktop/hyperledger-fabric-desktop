# 开发者文档
## 快速入门
1. 预览
2. 客户端尝试
3. 项目代码
4. 如何开发

### 1. 预览
客户端为开箱即用的，跨平台的(适用Windows, Mac, Linux），超级账本（hyperledger fabric）的图形化界面
客户端。客户端主要解决了Hyperledger Cello、Hyperledger Explorer中用户私钥非用户留存的问题，将用户
私钥留存用户本地，并具有数据看板、链码调用、链码安装等核心功能。

### 2. 客户端尝试
1. 用户登录
2. 数据看板
3. 链码调用
4. 链码安装

#### 2.1 用户登录
输入peer url，orderer url，username，并选择用户证书文件和私钥文件后，点击登录。

![登录页面](./img/login.png)
#### 2.2 数据看板
在数据看板中，我们可以看到区块相关信息。

![数据看板页面](./img/datacontent.png)
#### 2.3 链码调用
在链码调用界面中，输入通道名称、智能合约、函数名称、参数并选择是查询还是调用操作后，点击发送按钮，可获得相关
返回信息。

![链码调用页面](./img/ccquery.png)
#### 2.4 链码安装
在链码安装页面里，我们可以查看已经添加的各个智能合约的状态，是处于已经安装还是已经部署，并且我们可以添加新的
智能合约，输入链码名称、版本号、通道名称、链码文件路径和功能描述，点击添加按钮，即可添加新的智能合约，并
且可以在新的智能合约窗口中进行相关智能合约操作。

![链码安装页面](./img/ccinstall.png)

具体操作可参考[用户文档](./user.md)

### 3. 项目代码
#### 3.1 项目架构
- doc   项目文档
- fabric  后端网络配置相关文件
  - basic-network  基本网络配置文件
  - chaincode  链码相关文件
  - fabcar  链码操作脚本文件
- resources 前端客户端资源文件
- src     前端客户端主要文件
  - components    前端客户端界面文件
  - util 链码调用接口文件

#### 3.2 配置文件

也许您已经注意到了，在项目根目录下，会存在`.eslintrc` 、`.package.json`等配置文件，一般情况下，您不需要
额外去注意它，但当您引入新的外来库文件时，您可以手工修改或者通过类似`npm install`的命令自动引入新
的外来库并自动修改配置文件，当然了，我们不推荐手动去改，因为那样容易出错。

### 4. 如何开发
1. 开发环境必备条件
2. 安装依赖项及环境变量
3. 开发参考范例
4. 关于代码规范的说明

#### 4.1 开发环境必备条件：
* node.js：8.9.x 版本及以上，推荐8.x.x最新LTS版本 (9版本及以上暂不支持)
* docker：17.06.2-ce 版本及以上
* docker-compose：1.14.0 版本及以上

开发技术栈：Electron, React, Ant Design, Fabric-Node-sdk
推荐开发IDE：WebStorm 或 VSCode

#### 4.2 安装依赖项及环境变量

```
  npm install
```
在开发客户端时，在本地机上需要安装一些依赖项，如安装Electron、Eslint等，我们已经将需要安装的依赖项都已配置
在`package.json`文件里，因此要安装相关依赖项，直接在项目根目录下运行`npm install`即可，但因为国内网络
的限制，可能需要翻墙或者使用国内镜像，具体解决方法请见[Desktop-FAQ](./Desktop-FAQ.md)。

此外，使用MAC平台的开发者们需注意一个问题：在链码安装页面里，链码路径由于用到`GOPATH`环境变量，因此需要设置此
环境变量，在Linux下如果想设置环境变量，只要在用户主目录下的profile文件或者bash_profile里设置响应的export语句即可。
而在Mac下，其GUI程序和终端程序使用了两套不同的环境变量设置，具体设置方法请见[Desktop-FAQ](./Desktop-FAQ.md)。

#### 4.3 开发参考范例
我们将以如何开发通道管理功能为例来介绍如何开发我们的功能，如果您想开发新的功能，那么就一起来学习一下开发的具体过程吧！
如果您愿意让通道管理功能拥有一个单独的界面的话，那么开发过程可参考以下几个步骤：

1. 开发通道管理界面，我们可以把这个文件命名为`ChannelManageContent.jsx`
2. 开发通道管理接口，我们推荐在`fabric.js`中声明一个`ChannelManage`的函数
3. 如果通道管理功能需要数据持久化的话，我们需要新建一个NEDB数据库来完成持久化。

#### 4.3.1 开发通道管理界面

在`src/components/content`目录下，您可以新建一个`ChannelManageContent.jsx`文件。新建文件后，
并在`src/components/BasicLayout.jsx`增加相应的内容路由。

我们推荐react的es6语法来完成前端界面的书写，推荐的组件书写方式：

```react
import React,{ Component } from 'react';

class MyComponent extends Component {
  render() {
    return (
      <div>ES6方式创建的组件</div>
    );
  }
}
```
开发界面时，一定会使用到CSS样式,对于传统的网页开发来说，有一个原则是'关注点分离' 即结构，样式，行为分离，但是
对于React来说，React使用组件化开发界面，强制要求把HTML,CSS,Javascript写在一起，但这样会造成代码体积臃肿，
并且，考虑有全局CSS样式或者CSS复用的情况下，如果您希望把CSS单独写成一个`.css`文件，那么，您需要调研一下在
react+jsx+es6下如何导入外来`.css`文件，如果可行，那么就这样做吧.

如果一个页面中需要用到多个组件(class)的话，且多个组件不需要考虑复用的情况下，我们放开了eslint（代码规范约
束）对一个`.jsx`文件最多只有一个组件(class）的约束，您可以在一个`.jsx`文件中声明多个组件(class)，但注
意,多个组件(class)并存的话，一个`.jsx`文件只能export default 唯一的全局组件(class)。

除以上放开的一条eslint约束规则即一个`.jsx`文件可以有多个组件(class)，您需要保证您的代码满足其余所有的eslint
约束。

#### 4.3.2 开发通道管理接口
您可以另建一个文件，如`channel.js`来开发通道管理相关接口，但我们推荐把通道管理作为一个函数写进
`src/util`目录下的`fabric.js`文件中，在`fabric.js`中，有查询链码、调用链码、安装链码、实例化链码等
功能函数，所以我们推荐您将通道管理接口封装成一个函数，并写进`fabric.js`文件中。

#### 4.3.3 提交代码前注意检查代码规范
在您提交代码前请先用`npm run lint` 对代码进行检查，并且可以用`npm run lintFix ` 命令可对代码存在的一些不规范
的写法进行自动修复。

此外，可能还存在一些不能自动修复的问题，这时候您就需要根据IDE的提示，进行手工修复了。注意，IDE提示时，如果
显示是JShint或者JSlint的话，那么说明您此时的IDE的代码质量工具为JShint或者JSlint，所以您需要设置IDE的代码质量
工具为Eslint，如在webstorm中需设置Code Quality Tools为ESlint,并禁用其他代码质量工具。

### 4.4 关于代码规范的说明

我们采取了ESlint规范，并力求代码完全满足ESlint规范，但是在一些情况下，我们适当地放宽了ESlint规范的要求， 目前，
我们在两个地方放宽了对ESLint规范的要求。

1.我们按照Python的强制规范，允许在命名函数时，使用下划线_作为区分函数是公有函数还是私有函数，如果函数名前存在下划线_则认为是私有函数，
如无，则默认为共有函数。

2.如果一个.jsx文件中需要用到多个组件(class)的话，多个组件耦合度较大，且多个组件不需要考虑复用的情况下， 我们放开了eslint（代码规范约束）
对一个.jsx文件最多只有一个组件(class）的约束，您可以在一个.jsx文件 中声明多个组件(class)。

此外，如果您在开发的过程中，遇到了ESlint规范约束不恰当的情况下，注意，确实是ESlint规范约束不恰当，而不是为了可以偷个懒不去修改代码
中存在的不规范的地方，可以在github上提出相关issue，并在查明属实后，可以放开此ESlint规范约束。

#### 4.4 开发路线
* v0.1.0 : 基础功能（数据看板、链码调用、链码安装）。
* v0.2.0：开发通道相关功能，并完善基础功能和架构。
* v0.3.0~: 逐步添加其他功能，逐步完善基础架构

客户端目前处于v0.1.0版本阶段。
